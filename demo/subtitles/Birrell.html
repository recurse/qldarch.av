<html>
  <head>
    <script src="./popcorn-complete.min.js" type="text/javascript"></script>
    <script src="./jquery-1.7.2.min.js" type="text/javascript"></script>
  </head>
  <body>
    <h1 id="title"></h1>
    <div id="date"></div>
    <div style="padding:1em">
    <audio controls="controls" id="ourvideo">
      <source src="./Birrell_JM_and_AW.mp3" type="audio/mp3">
      <source src="./Birrell_JM_and_AW.ogg" type="audio/ogg">
    </audio>
    <div id="subtitles"></div>
        <div id="speaker"></div>
        <div id="speech"></div>
    </div>
    <script type="text/javascript">
    $(document).ready(function() {
        var speakers;
        $.getJSON("./Birrell_Speakers.json", function(data) {
            speakers = data;
        });

        function exchangeUpdater(exchange) {
            return function(options) {
                console.log(options);
                $("#speaker").text(speakers[exchange.speaker]);
                $("#speech").text(exchange.transcript);
            };
        }

        $.getJSON("./Birrell.json", function(data) {
            console.log(data);
            $("#title").text(data.title);
            $("#date").text(data.date);

            var popcorn = Popcorn("#ourvideo");
            for each (var exchange in data.exchanges) {
                popcorn.cue(Popcorn.util.toSeconds(exchange.time) - 0.5, exchangeUpdater(exchange));
            }

            popcorn.play();
        });

    });
    </script>
  </body>
</html>
